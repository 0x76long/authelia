<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Proxy Integration - Authelia</title> <link rel="shortcut icon" href="https://docs.authelia.com/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://docs.authelia.com/assets/css/just-the-docs.css"> <script type="text/javascript" src="https://docs.authelia.com/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://docs.authelia.com/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Proxy Integration | Authelia</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Proxy Integration" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <link rel="canonical" href="https://docs.authelia.com/deployment/supported-proxies/" /> <meta property="og:url" content="https://docs.authelia.com/deployment/supported-proxies/" /> <meta property="og:site_name" content="Authelia" /> <script type="application/ld+json"> {"@type":"WebPage","url":"https://docs.authelia.com/deployment/supported-proxies/","headline":"Proxy Integration","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.authelia.com/images/authelia-title.png"}},"description":"Authelia is an open source multi-factor single sign-on portal for web applications","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"> </path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://docs.authelia.com" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="https://docs.authelia.com/" class="navigation-list-link">Home</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/home/architecture.html" class="navigation-list-link">Architecture</a></li></ul></li><li class="navigation-list-item"><a href="https://docs.authelia.com/getting-started.html" class="navigation-list-link">Getting Started</a></li><li class="navigation-list-item"><a href="https://docs.authelia.com/features/" class="navigation-list-link">Features</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/features/first-factor.html" class="navigation-list-link">First Factor</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/features/2fa/" class="navigation-list-link">Second Factor</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://docs.authelia.com/features/2fa/one-time-password.html" class="navigation-list-link">One-Time Password</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/features/2fa/security-key.html" class="navigation-list-link">Security Keys</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/features/2fa/push-notifications.html" class="navigation-list-link">Push Notification</a> </li></ul></li><li class="navigation-list-item "><a href="https://docs.authelia.com/features/single-factor.html" class="navigation-list-link">Single Factor</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/features/password-reset.html" class="navigation-list-link">Password Reset</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/features/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/features/regulation.html" class="navigation-list-link">Regulation</a></li></ul></li><li class="navigation-list-item"><a href="https://docs.authelia.com/configuration/" class="navigation-list-link">Configuration</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/authentication/" class="navigation-list-link">Authentication backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/authentication/file.html" class="navigation-list-link">File</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/authentication/ldap.html" class="navigation-list-link">LDAP</a> </li></ul></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/duo-push-notifications.html" class="navigation-list-link">Duo Push Notifications</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/miscellaneous.html" class="navigation-list-link">Miscellaneous</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/one-time-password.html" class="navigation-list-link">One-Time Password</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/regulation.html" class="navigation-list-link">Regulation</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/notifier/" class="navigation-list-link">Notifier</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/notifier/filesystem.html" class="navigation-list-link">Filesystem</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/notifier/smtp.html" class="navigation-list-link">SMTP</a> </li></ul></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/secrets.html" class="navigation-list-link">Secrets</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/server.html" class="navigation-list-link">Server</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/session.html" class="navigation-list-link">Session</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/configuration/storage/" class="navigation-list-link">Storage backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/storage/mariadb.html" class="navigation-list-link">MariaDB</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/storage/mysql.html" class="navigation-list-link">MySQL</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/storage/postgres.html" class="navigation-list-link">PostgreSQL</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/configuration/storage/sqlite.html" class="navigation-list-link">SQLite</a> </li></ul></li></ul></li><li class="navigation-list-item active"><a href="https://docs.authelia.com/deployment/" class="navigation-list-link">Deployment</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/deployment/deployment-lite.html" class="navigation-list-link">Deployment - Lite</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/deployment/deployment-ha.html" class="navigation-list-link">Deployment - Highly-Available</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/deployment/deployment-kubernetes.html" class="navigation-list-link">Deployment - Kubernetes</a></li><li class="navigation-list-item active"><a href="https://docs.authelia.com/deployment/supported-proxies/" class="navigation-list-link active">Proxy Integration</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://docs.authelia.com/deployment/supported-proxies/haproxy.html" class="navigation-list-link">HAProxy</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/deployment/supported-proxies/nginx.html" class="navigation-list-link">Nginx</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/deployment/supported-proxies/traefik1.x.html" class="navigation-list-link">Traefik 1.x</a> </li><li class="navigation-list-item "> <a href="https://docs.authelia.com/deployment/supported-proxies/traefik2.x.html" class="navigation-list-link">Traefik 2.x</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://docs.authelia.com/security/" class="navigation-list-link">Security</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/security/measures.html" class="navigation-list-link">Security Measures</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/security/threat-model.html" class="navigation-list-link">Threat Model</a></li></ul></li><li class="navigation-list-item"><a href="https://docs.authelia.com/contributing/" class="navigation-list-link">Contributing</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/contributing/authelia-scripts.html" class="navigation-list-link">Authelia Scripts</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/contributing/build-and-dev.html" class="navigation-list-link">Build & Dev</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/contributing/suites.html" class="navigation-list-link">Suites</a></li></ul></li><li class="navigation-list-item"><a href="https://docs.authelia.com/faq.html" class="navigation-list-link">FAQ</a></li><li class="navigation-list-item"><a href="https://docs.authelia.com/roadmap.html" class="navigation-list-link">Roadmap</a></li><li class="navigation-list-item"><a href="https://docs.authelia.com/community/" class="navigation-list-link">Community</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://docs.authelia.com/community/two-factor-basic-auth.html" class="navigation-list-link">2FA through basic auth</a></li><li class="navigation-list-item "><a href="https://docs.authelia.com/community/using-remote-user-header-for-sso-with-jira.html" class="navigation-list-link">Using Remote-User header for SSO with Jira</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"> <title>Search</title> <g fill-rule="nonzero"> <path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" /> <path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" /> </g> </svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://docs.authelia.com/deployment/">Deployment</a> </li> <li class="breadcrumb-nav-list-item"><span>Proxy Integration</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 id="integration-with-proxies"> <a href="#integration-with-proxies" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Integration with proxies </h1> <p><strong>Authelia</strong> works in collaboration with reverse proxies. In the sub-pages you can find the documentation of the configuration required for every supported proxy.</p> <p>If you are not aware of the workflow of an authentication request, reading this <a href="/home/architecture.html">documentation</a> first is highly recommended.</p> <h2 id="how-authelia-integrates-with-proxies"> <a href="#how-authelia-integrates-with-proxies" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> How Authelia integrates with proxies? </h2> <p>Authelia takes authentication requests coming from the proxy and targeting the <code class="language-plaintext highlighter-rouge">/api/verify</code> endpoint exposed by Authelia. Two pieces of information are required for Authelia to be able to authenticate the user request:</p> <ul> <li>The session cookie or a <code class="language-plaintext highlighter-rouge">Proxy-Authorization</code> header (see <a href="/features/single-factor.html">single factor authentication</a>).</li> <li>The target URL of the user request (used primarily for <a href="/features/access-control.html">access control</a>).</li> </ul> <p>The target URL can be provided using one of the following ways:</p> <ul> <li>With <code class="language-plaintext highlighter-rouge">X-Original-URL</code> header containing the complete URL of the initial request.</li> <li>With a combination of <code class="language-plaintext highlighter-rouge">X-Forwarded-Proto</code>, <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> and <code class="language-plaintext highlighter-rouge">X-Forwarded-URI</code> headers.</li> </ul> <p>In the case of Traefik, these headers are automatically provided and therefore don’t appear in the configuration examples.</p> <h2 id="how-can-the-backend-be-aware-of-the-authenticated-users"> <a href="#how-can-the-backend-be-aware-of-the-authenticated-users" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> How can the backend be aware of the authenticated users? </h2> <p>The only way Authelia can share information about the authenticated user currently is through the use of two HTTP headers: <code class="language-plaintext highlighter-rouge">Remote-User</code> and <code class="language-plaintext highlighter-rouge">Remote-Groups</code>. Those headers are returned by Authelia on requests to <code class="language-plaintext highlighter-rouge">/api/verify</code> and must be forwarded by the reverse proxy to the backends needing them. Please note that the backend must support the use of those headers to leverage that information, many backends still don’t (and probably won’t) support it. However, we are working on solving this issue with OpenID Connect/OAuth2 which is a widely adopted open standard for access delegation.</p> <p>So, if you’re developing your own application, you can read those headers and use them. If you don’t own the codebase of the backend, you need to check whether it supports this type of authentication or not. If it does not, you have three options:</p> <ol> <li>Enable authentication on the backend and make your users authenticate twice (not user-friendly).</li> <li>Completely disable the authentication of your backend. This works only if all your users share the same privileges in the backend.</li> <li>Many applications support OAuth2 so the last option would be to just wait for Authelia to be an OpenID Connect provider (https://github.com/authelia/authelia/issues/189).</li> </ol> <h2 id="redirection-to-the-login-portal"> <a href="#redirection-to-the-login-portal" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Redirection to the login portal </h2> <p>The endpoint <code class="language-plaintext highlighter-rouge">/api/verify</code> has different behaviors depending on whether the <code class="language-plaintext highlighter-rouge">rd</code> (for redirection) query parameter is provided.</p> <p>If redirection parameter is provided and contains the URL to the login portal served by Authelia, the request will either generate a 200 response if the request is authenticated or perform a redirection (302 response) to the login portal if not authenticated yet.</p> <p>If no redirection parameter is provided, the response code is either 200 or 401. The redirection must then be handled by the proxy when an error is detected (see <a href="/deployment/supported-proxies/nginx.html">nginx</a> example).</p> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="https://docs.authelia.com/deployment/supported-proxies/haproxy.html">HAProxy</a> </li> <li> <a href="https://docs.authelia.com/deployment/supported-proxies/nginx.html">Nginx</a> </li> <li> <a href="https://docs.authelia.com/deployment/supported-proxies/traefik1.x.html">Traefik 1.x</a> </li> <li> <a href="https://docs.authelia.com/deployment/supported-proxies/traefik2.x.html">Traefik 2.x</a> </li> </ul> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
