<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Threat Model - Authelia</title> <link rel="shortcut icon" href="/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-124926127-1'); </script> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Threat Model | Authelia</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Threat Model" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:site_name" content="Authelia" /> <script type="application/ld+json"> {"headline":"Threat Model","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/images/authelia-title.png"}},"url":"/docs/security/threat-model.html","description":"Authelia is an open source multi-factor single sign-on portal for web applications","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"> </path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="/docs/" class="navigation-list-link">Home</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/home/architecture.html" class="navigation-list-link">Architecture</a></li></ul></li><li class="navigation-list-item"><a href="/docs/getting-started.html" class="navigation-list-link">Getting Started</a></li><li class="navigation-list-item"><a href="/docs/features/" class="navigation-list-link">Features</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/features/first-factor.html" class="navigation-list-link">First Factor</a></li><li class="navigation-list-item "><a href="/docs/features/2fa/" class="navigation-list-link">Second Factor</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="/docs/features/2fa/one-time-password.html" class="navigation-list-link">One-Time Password</a> </li><li class="navigation-list-item "> <a href="/docs/features/2fa/security-key.html" class="navigation-list-link">Security Keys</a> </li><li class="navigation-list-item "> <a href="/docs/features/2fa/push-notifications.html" class="navigation-list-link">Push Notification</a> </li></ul></li><li class="navigation-list-item "><a href="/docs/features/single-factor.html" class="navigation-list-link">Single Factor</a></li><li class="navigation-list-item "><a href="/docs/features/password-reset.html" class="navigation-list-link">Password Reset</a></li><li class="navigation-list-item "><a href="/docs/features/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="/docs/features/regulation.html" class="navigation-list-link">Regulation</a></li></ul></li><li class="navigation-list-item"><a href="/docs/configuration/" class="navigation-list-link">Configuration</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/configuration/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="/docs/configuration/authentication/" class="navigation-list-link">Authentication backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="/docs/configuration/authentication/file.html" class="navigation-list-link">File</a> </li><li class="navigation-list-item "> <a href="/docs/configuration/authentication/ldap.html" class="navigation-list-link">LDAP</a> </li></ul></li><li class="navigation-list-item "><a href="/docs/configuration/duo-push-notifications.html" class="navigation-list-link">Duo Push Notifications</a></li><li class="navigation-list-item "><a href="/docs/configuration/miscellaneous.html" class="navigation-list-link">Miscellaneous</a></li><li class="navigation-list-item "><a href="/docs/configuration/one-time-password.html" class="navigation-list-link">One-Time Password</a></li><li class="navigation-list-item "><a href="/docs/configuration/regulation.html" class="navigation-list-link">Regulation</a></li><li class="navigation-list-item "><a href="/docs/configuration/secrets.html" class="navigation-list-link">Secrets</a></li><li class="navigation-list-item "><a href="/docs/configuration/notifier/" class="navigation-list-link">Notifier</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="/docs/configuration/notifier/filesystem.html" class="navigation-list-link">Filesystem</a> </li><li class="navigation-list-item "> <a href="/docs/configuration/notifier/smtp.html" class="navigation-list-link">SMTP</a> </li></ul></li><li class="navigation-list-item "><a href="/docs/configuration/server.html" class="navigation-list-link">Server</a></li><li class="navigation-list-item "><a href="/docs/configuration/session.html" class="navigation-list-link">Session</a></li><li class="navigation-list-item "><a href="/docs/configuration/storage/" class="navigation-list-link">Storage backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="/docs/configuration/storage/mariadb.html" class="navigation-list-link">MariaDB</a> </li><li class="navigation-list-item "> <a href="/docs/configuration/storage/mysql.html" class="navigation-list-link">MySQL</a> </li><li class="navigation-list-item "> <a href="/docs/configuration/storage/postgres.html" class="navigation-list-link">PostgreSQL</a> </li><li class="navigation-list-item "> <a href="/docs/configuration/storage/sqlite.html" class="navigation-list-link">SQLite</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="/docs/deployment/" class="navigation-list-link">Deployment</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/deployment/deployment-ha.html" class="navigation-list-link">Deployment - Highly-Available</a></li><li class="navigation-list-item "><a href="/docs/deployment/deployment-kubernetes.html" class="navigation-list-link">Deployment - Kubernetes</a></li><li class="navigation-list-item "><a href="/docs/deployment/supported-proxies/" class="navigation-list-link">Proxy Integration</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="/docs/deployment/supported-proxies/haproxy.html" class="navigation-list-link">HAProxy</a> </li><li class="navigation-list-item "> <a href="/docs/deployment/supported-proxies/nginx.html" class="navigation-list-link">Nginx</a> </li><li class="navigation-list-item "> <a href="/docs/deployment/supported-proxies/traefik1.x.html" class="navigation-list-link">Traefik 1.x</a> </li><li class="navigation-list-item "> <a href="/docs/deployment/supported-proxies/traefik2.x.html" class="navigation-list-link">Traefik 2.x</a> </li></ul></li><li class="navigation-list-item "><a href="/docs/deployment/deployment-lite.html" class="navigation-list-link">Deployment - Lite</a></li></ul></li><li class="navigation-list-item active"><a href="/docs/security/" class="navigation-list-link">Security</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/security/measures.html" class="navigation-list-link">Security Measures</a></li><li class="navigation-list-item active"><a href="/docs/security/threat-model.html" class="navigation-list-link active">Threat Model</a></li></ul></li><li class="navigation-list-item"><a href="/docs/contributing/" class="navigation-list-link">Contributing</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/contributing/build-and-dev.html" class="navigation-list-link">Build & Dev</a></li><li class="navigation-list-item "><a href="/docs/contributing/suites.html" class="navigation-list-link">Suites</a></li><li class="navigation-list-item "><a href="/docs/contributing/authelia-scripts.html" class="navigation-list-link">Authelia Scripts</a></li></ul></li><li class="navigation-list-item"><a href="/docs/faq.html" class="navigation-list-link">FAQ</a></li><li class="navigation-list-item"><a href="/docs/roadmap.html" class="navigation-list-link">Roadmap</a></li><li class="navigation-list-item"><a href="/docs/community/" class="navigation-list-link">Community</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/community/two-factor-basic-auth.html" class="navigation-list-link">2FA through basic auth</a></li><li class="navigation-list-item "><a href="/docs/community/using-remote-user-header-for-sso-with-jira.html" class="navigation-list-link">Using Remote-User header for SSO with Jira</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"> <title>Search</title> <g fill-rule="nonzero"> <path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" /> <path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" /> </g> </svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/security/">Security</a> </li> <li class="breadcrumb-nav-list-item"><span>Threat Model</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 id="threat-model"> <a href="#threat-model" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Threat Model </h1> <p>The design goals for Authelia is to protect access to applications by collaborating with reverse proxies to prevent attacks coming from the edge of the network. This document gives an overview of what Authelia is protecting against but some of those points are also detailed in <a href="/docs/security/measures.html">Security Measures</a>.</p> <h2 id="general-assumptions"> <a href="#general-assumptions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> General assumptions </h2> <p>Authelia is considered to be running within a trusted network and it heavily relies on the first level of security provided by reverse proxies. It’s very important that you take time configuring your reverse proxy properly to get all the authentication benefits brought by Authelia. Some general security tweaks are listed in <a href="/docs/security/measures.html">Security Measures</a> to give you some ideas.</p> <h2 id="guarantees"> <a href="#guarantees" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Guarantees </h2> <p>If properly configured, Authelia guarantees the following for security of your users and your apps:</p> <ul> <li>Applications cannot be accessed without proper authorization. The access control list is highly configurable allowing administrators to guarantee least privilege principle.</li> <li>Applications can be protected with two factors in order to fight against credentials theft and protect highly sensitive data or operations.</li> <li>Sessions are bound in time, limiting the impact of a cookie theft. Sessions can have both soft and hard limits. With soft limit, the user is logged out when inactive for a certain period. With hard limit, the user has to authenticate again after a certain period, whether they were active or not.</li> <li>Brute force attacks against credentials are protected thanks to a regulation mechanism temporarily blocking the user account after too many attempts.</li> <li>Identity validation is required for performing administrative actions such as registering 2FA devices, preventing attackers to pass second factor by auto-registering their own 2FA device. An email with a link is sent to the user and a click is required to confirm the action.</li> <li>Prevention against session fixation by regenerating a new session after each privilege elevation.</li> <li>Prevention against LDAP injection by following OWASP recommendations regarding valid input characters (https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html).</li> <li>Connections between Authelia and thirdparty components like mail server, database, cache and LDAP server can be made over TLS to protect against man-in-the-middle attacks from within the infrastructure.</li> <li>Validation of user session group memberships gets refreshed regularly from the authentication backend (LDAP only).</li> </ul> <h2 id="potential-future-guarantees"> <a href="#potential-future-guarantees" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Potential future guarantees </h2> <ul> <li>Define and enforce a password policy (to be designed since such a policy can clash with a policy set by the LDAP server).</li> <li>Detect credential theft and prevent malicious actions.</li> <li>Detect session cookie theft and prevent malicious actions.</li> <li>Authenticate communications between Authelia and reverse proxy.</li> <li>Securely transmit authentication data to backends (OAuth2 with bearer tokens).</li> <li>Protect secrets stored in DB with encryption to prevent secrets leak by DB exfiltration.</li> <li>Least privilege on LDAP binding operations (currently administrative user is used to bind while it could be anonymous).</li> <li>Extend the check of user group memberships to authentication backends other than LDAP (File currently).</li> <li>Invalidate user session after profile or membership has changed in order to drop remaining privileges on the fly.</li> </ul> <h2 id="trusted-environment"> <a href="#trusted-environment" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Trusted environment </h2> <p>It’s important to note that Authelia is considered running in a trusted environment for two reasons</p> <ol> <li>Requests coming to Authelia should be initiated by reverse proxies but CAN be initiated by any other server currently. There is no trusted relationship between Authelia and the reverse proxy so an attacker within the network could abuse Authelia and attack it.</li> <li>Your environment should be considered trusted especially if you’re using the <code class="language-plaintext highlighter-rouge">Remote-User</code> and <code class="language-plaintext highlighter-rouge">Remote-Groups</code> headers to forward authentication data to your backends. These headers are transmitted plain and unsigned to the backends, meaning a malicious user within the network could pretend to be Authelia and send those headers to bypass authentication and gain access to the service. A mitigation could be to transmit those headers with a digital signature which could be verified by the backend however, many backends just don’t support it. It has therefore been decided to invest on OpenID Connect instead to solve that authentication delegation problem. Indeed, many backends do support OAuth2 though since it has become a standard lately.</li> </ol> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
