<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Threat Model - Authelia</title> <link rel="shortcut icon" href="/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-124926127-1'); </script> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Threat Model | Authelia</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Threat Model" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:site_name" content="Authelia" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Threat Model" /> <script type="application/ld+json"> {"headline":"Threat Model","description":"Authelia is an open source multi-factor single sign-on portal for web applications","url":"/docs/security/threat-model.html","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/images/authelia-title.png"}},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/" class="nav-list-link">Home</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/home/architecture.html" class="nav-list-link">Architecture</a></li></ul></li><li class="nav-list-item"><a href="/docs/getting-started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/" class="nav-list-link">Features</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/features/first-factor.html" class="nav-list-link">First Factor</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/2fa/" class="nav-list-link">Second Factor</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/features/2fa/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/security-key.html" class="nav-list-link">Security Keys</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/push-notifications.html" class="nav-list-link">Push Notification</a> </li></ul></li><li class="nav-list-item "><a href="/docs/features/single-factor.html" class="nav-list-link">Single Factor</a></li><li class="nav-list-item "><a href="/docs/features/password-reset.html" class="nav-list-link">Password Reset</a></li><li class="nav-list-item "><a href="/docs/features/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="/docs/features/regulation.html" class="nav-list-link">Regulation</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/configuration/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/authentication/" class="nav-list-link">Authentication backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/authentication/file.html" class="nav-list-link">File</a> </li><li class="nav-list-item "> <a href="/docs/configuration/authentication/ldap.html" class="nav-list-link">LDAP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/duo-push-notifications.html" class="nav-list-link">Duo Push Notifications</a></li><li class="nav-list-item "><a href="/docs/configuration/miscellaneous.html" class="nav-list-link">Miscellaneous</a></li><li class="nav-list-item "><a href="/docs/configuration/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a></li><li class="nav-list-item "><a href="/docs/configuration/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="/docs/configuration/secrets.html" class="nav-list-link">Secrets</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/notifier/" class="nav-list-link">Notifier</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/notifier/filesystem.html" class="nav-list-link">Filesystem</a> </li><li class="nav-list-item "> <a href="/docs/configuration/notifier/smtp.html" class="nav-list-link">SMTP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/server.html" class="nav-list-link">Server</a></li><li class="nav-list-item "><a href="/docs/configuration/session.html" class="nav-list-link">Session</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/storage/" class="nav-list-link">Storage backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/storage/mariadb.html" class="nav-list-link">MariaDB</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/mysql.html" class="nav-list-link">MySQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/postgres.html" class="nav-list-link">PostgreSQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/sqlite.html" class="nav-list-link">SQLite</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/theme.html" class="nav-list-link">Theme</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/" class="nav-list-link">Deployment</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/deployment/deployment-lite.html" class="nav-list-link">Deployment - Lite</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-ha.html" class="nav-list-link">Deployment - Highly-Available</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-kubernetes.html" class="nav-list-link">Deployment - Kubernetes</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/supported-proxies/" class="nav-list-link">Proxy Integration</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/haproxy.html" class="nav-list-link">HAProxy</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/nginx.html" class="nav-list-link">Nginx</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik1.x.html" class="nav-list-link">Traefik 1.x</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik2.x.html" class="nav-list-link">Traefik 2.x</a> </li></ul></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/security/measures.html" class="nav-list-link">Security Measures</a></li><li class="nav-list-item active"><a href="/docs/security/threat-model.html" class="nav-list-link active">Threat Model</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/contributing/" class="nav-list-link">Contributing</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/contributing/build-and-dev.html" class="nav-list-link">Build & Dev</a></li><li class="nav-list-item "><a href="/docs/contributing/authelia-scripts.html" class="nav-list-link">Authelia Scripts</a></li><li class="nav-list-item "><a href="/docs/contributing/commitmsg-guidelines.html" class="nav-list-link">Commit Message Guidelines</a></li><li class="nav-list-item "><a href="/docs/contributing/suites.html" class="nav-list-link">Suites</a></li></ul></li><li class="nav-list-item"><a href="/docs/faq.html" class="nav-list-link">FAQ</a></li><li class="nav-list-item"><a href="/docs/roadmap.html" class="nav-list-link">Roadmap</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/community/" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/community/two-factor-basic-auth.html" class="nav-list-link">2FA through basic auth</a></li><li class="nav-list-item "><a href="/docs/community/using-remote-user-header-for-sso-with-jira.html" class="nav-list-link">Using Remote-User header for SSO with Jira</a></li><li class="nav-list-item "><a href="/docs/community/additional-resources.html" class="nav-list-link">Miscellaneous Additional Resources</a></li><li class="nav-list-item "><a href="/docs/community/example-of-authelia-lite-on-docker-swarm.html" class="nav-list-link">Example of authelia lite on docker swarm</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Security</a></li> <li class="breadcrumb-nav-list-item"><span>Threat Model</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="threat-model"> <a href="#threat-model" class="anchor-heading" aria-labelledby="threat-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Threat Model </h1> <p>The design goals for Authelia is to protect access to applications by collaborating with reverse proxies to prevent attacks coming from the edge of the network. This document gives an overview of what Authelia is protecting against but some of those points are also detailed in <a href="/docs/security/measures.html">Security Measures</a>.</p> <h2 id="general-assumptions"> <a href="#general-assumptions" class="anchor-heading" aria-labelledby="general-assumptions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General assumptions </h2> <p>Authelia is considered to be running within a trusted network and it heavily relies on the first level of security provided by reverse proxies. It’s very important that you take time configuring your reverse proxy properly to get all the authentication benefits brought by Authelia. Some general security tweaks are listed in <a href="/docs/security/measures.html">Security Measures</a> to give you some ideas.</p> <h2 id="guarantees"> <a href="#guarantees" class="anchor-heading" aria-labelledby="guarantees"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Guarantees </h2> <p>If properly configured, Authelia guarantees the following for security of your users and your apps:</p> <ul> <li>Applications cannot be accessed without proper authorization. The access control list is highly configurable allowing administrators to guarantee least privilege principle.</li> <li>Applications can be protected with two factors in order to fight against credentials theft and protect highly sensitive data or operations.</li> <li>Sessions are bound in time, limiting the impact of a cookie theft. Sessions can have both soft and hard limits. With soft limit, the user is logged out when inactive for a certain period. With hard limit, the user has to authenticate again after a certain period, whether they were active or not.</li> <li>Brute force attacks against credentials are protected thanks to a regulation mechanism temporarily blocking the user account after too many attempts.</li> <li>Identity validation is required for performing administrative actions such as registering 2FA devices, preventing attackers to pass second factor by auto-registering their own 2FA device. An email with a link is sent to the user and a click is required to confirm the action.</li> <li>Prevention against session fixation by regenerating a new session after each privilege elevation.</li> <li>Prevention against LDAP injection by following OWASP recommendations regarding valid input characters (https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html).</li> <li>Connections between Authelia and thirdparty components like mail server, database, cache and LDAP server can be made over TLS to protect against man-in-the-middle attacks from within the infrastructure.</li> <li>Validation of user session group memberships gets refreshed regularly from the authentication backend (LDAP only).</li> </ul> <h2 id="potential-future-guarantees"> <a href="#potential-future-guarantees" class="anchor-heading" aria-labelledby="potential-future-guarantees"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Potential future guarantees </h2> <ul> <li>Define and enforce a password policy (to be designed since such a policy can clash with a policy set by the LDAP server).</li> <li>Detect credential theft and prevent malicious actions.</li> <li>Detect session cookie theft and prevent malicious actions.</li> <li>Authenticate communications between Authelia and reverse proxy.</li> <li>Securely transmit authentication data to backends (OAuth2 with bearer tokens).</li> <li>Protect secrets stored in DB with encryption to prevent secrets leak by DB exfiltration.</li> <li>Least privilege on LDAP binding operations (currently administrative user is used to bind while it could be anonymous).</li> <li>Extend the check of user group memberships to authentication backends other than LDAP (File currently).</li> <li>Invalidate user session after profile or membership has changed in order to drop remaining privileges on the fly.</li> </ul> <h2 id="trusted-environment"> <a href="#trusted-environment" class="anchor-heading" aria-labelledby="trusted-environment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trusted environment </h2> <p>It’s important to note that Authelia is considered running in a trusted environment for two reasons</p> <ol> <li>Requests coming to Authelia should be initiated by reverse proxies but CAN be initiated by any other server currently. There is no trusted relationship between Authelia and the reverse proxy so an attacker within the network could abuse Authelia and attack it.</li> <li>Your environment should be considered trusted especially if you’re using the <code class="language-plaintext highlighter-rouge">Remote-User</code>, <code class="language-plaintext highlighter-rouge">Remote-Name</code>, <code class="language-plaintext highlighter-rouge">Remote-Email</code> and <code class="language-plaintext highlighter-rouge">Remote-Groups</code> headers to forward authentication data to your backends. These headers are transmitted plain and unsigned to the backends, meaning a malicious user within the network could pretend to be Authelia and send those headers to bypass authentication and gain access to the service. A mitigation could be to transmit those headers with a digital signature which could be verified by the backend however, many backends just don’t support it. It has therefore been decided to invest on OpenID Connect instead to solve that authentication delegation problem. Indeed, many backends do support OAuth2 though since it has become a standard lately.</li> </ol> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2021 Authelia. Distributed by an <a href=\"https://github.com/authelia/authelia/blob/master/LICENSE\">Apache 2.0 license.</a> </p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
