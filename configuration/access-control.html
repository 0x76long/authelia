<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Access Control - Authelia</title> <link rel="shortcut icon" href="/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-124926127-1'); </script> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Access Control | Authelia</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Access Control" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:site_name" content="Authelia" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Access Control" /> <script type="application/ld+json"> {"description":"Authelia is an open source multi-factor single sign-on portal for web applications","url":"/docs/configuration/access-control.html","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/images/authelia-title.png"}},"headline":"Access Control","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/" class="nav-list-link">Home</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/home/architecture.html" class="nav-list-link">Architecture</a></li></ul></li><li class="nav-list-item"><a href="/docs/getting-started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/" class="nav-list-link">Features</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/features/first-factor.html" class="nav-list-link">First Factor</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/2fa/" class="nav-list-link">Second Factor</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/features/2fa/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/security-key.html" class="nav-list-link">Security Keys</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/push-notifications.html" class="nav-list-link">Push Notification</a> </li></ul></li><li class="nav-list-item "><a href="/docs/features/single-factor.html" class="nav-list-link">Single Factor</a></li><li class="nav-list-item "><a href="/docs/features/password-reset.html" class="nav-list-link">Password Reset</a></li><li class="nav-list-item "><a href="/docs/features/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="/docs/features/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="/docs/features/statelessness.html" class="nav-list-link">Statelessness</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list "><li class="nav-list-item active"><a href="/docs/configuration/access-control.html" class="nav-list-link active">Access Control</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/authentication/" class="nav-list-link">Authentication backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/authentication/file.html" class="nav-list-link">File</a> </li><li class="nav-list-item "> <a href="/docs/configuration/authentication/ldap.html" class="nav-list-link">LDAP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/duo-push-notifications.html" class="nav-list-link">Duo Push Notifications</a></li><li class="nav-list-item "><a href="/docs/configuration/miscellaneous.html" class="nav-list-link">Miscellaneous</a></li><li class="nav-list-item "><a href="/docs/configuration/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a></li><li class="nav-list-item "><a href="/docs/configuration/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/notifier/" class="nav-list-link">Notifier</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/notifier/filesystem.html" class="nav-list-link">Filesystem</a> </li><li class="nav-list-item "> <a href="/docs/configuration/notifier/smtp.html" class="nav-list-link">SMTP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/secrets.html" class="nav-list-link">Secrets</a></li><li class="nav-list-item "><a href="/docs/configuration/server.html" class="nav-list-link">Server</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/session/" class="nav-list-link">Session</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/session/redis.html" class="nav-list-link">Redis</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/storage/" class="nav-list-link">Storage backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/storage/mariadb.html" class="nav-list-link">MariaDB</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/mysql.html" class="nav-list-link">MySQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/postgres.html" class="nav-list-link">PostgreSQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/sqlite.html" class="nav-list-link">SQLite</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/theme.html" class="nav-list-link">Theme</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/" class="nav-list-link">Deployment</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/deployment/deployment-lite.html" class="nav-list-link">Deployment - Lite</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-ha.html" class="nav-list-link">Deployment - Highly-Available</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-kubernetes.html" class="nav-list-link">Deployment - Kubernetes</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/supported-proxies/" class="nav-list-link">Proxy Integration</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/haproxy.html" class="nav-list-link">HAProxy</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/nginx.html" class="nav-list-link">Nginx</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik2.x.html" class="nav-list-link">Traefik 2.x</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik1.x.html" class="nav-list-link">Traefik 1.x</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/security/measures.html" class="nav-list-link">Security Measures</a></li><li class="nav-list-item "><a href="/docs/security/threat-model.html" class="nav-list-link">Threat Model</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/contributing/" class="nav-list-link">Contributing</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/contributing/build-and-dev.html" class="nav-list-link">Build & Dev</a></li><li class="nav-list-item "><a href="/docs/contributing/authelia-scripts.html" class="nav-list-link">Authelia Scripts</a></li><li class="nav-list-item "><a href="/docs/contributing/commitmsg-guidelines.html" class="nav-list-link">Commit Message Guidelines</a></li><li class="nav-list-item "><a href="/docs/contributing/style-guide.html" class="nav-list-link">Style Guide</a></li><li class="nav-list-item "><a href="/docs/contributing/suites.html" class="nav-list-link">Suites</a></li></ul></li><li class="nav-list-item"><a href="/docs/faq.html" class="nav-list-link">FAQ</a></li><li class="nav-list-item"><a href="/docs/roadmap.html" class="nav-list-link">Roadmap</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/community/" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/community/two-factor-basic-auth.html" class="nav-list-link">2FA through basic auth</a></li><li class="nav-list-item "><a href="/docs/community/using-remote-user-header-for-sso-with-jira.html" class="nav-list-link">Using Remote-User header for SSO with Jira</a></li><li class="nav-list-item "><a href="/docs/community/additional-resources.html" class="nav-list-link">Miscellaneous Additional Resources</a></li><li class="nav-list-item "><a href="/docs/community/example-of-authelia-lite-on-docker-swarm.html" class="nav-list-link">Example of authelia lite on docker swarm</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>Access Control</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="access-control"> <a href="#access-control" class="anchor-heading" aria-labelledby="access-control"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Access Control </h1> <h2 id="policies"> <a href="#policies" class="anchor-heading" aria-labelledby="policies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Policies </h2> <p>With <strong>Authelia</strong> you can define a list of rules that are going to be evaluated in sequential order when authorization is delegated to Authelia.</p> <p>The first matching rule of the list defines the policy applied to the resource, if no rule matches the resource a customizable default policy is applied.</p> <h3 id="deny"> <a href="#deny" class="anchor-heading" aria-labelledby="deny"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> deny </h3> <p>This is the policy applied by default, and is what we recommend as the default policy for all installs. Its effect is literally to deny the user access to the resource. Additionally you can use this policy to conditionally deny access in desired situations. Examples include denying access to an API that has no authentication mechanism built in.</p> <h3 id="bypass"> <a href="#bypass" class="anchor-heading" aria-labelledby="bypass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> bypass </h3> <p>This policy skips all authentication and allows anyone to use the resource. This policy is not available with a rule that includes a <a href="#Subjects">subject</a> restriction because the minimum authentication level required to obtain information about the subject is <a href="#one_factor">one_factor</a>.</p> <h3 id="one_factor"> <a href="#one_factor" class="anchor-heading" aria-labelledby="one_factor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> one_factor </h3> <p>This policy requires the user at minimum complete 1FA successfully (username and password). This means if they have performed 2FA then they will be allowed to access the resource.</p> <h3 id="two_factor"> <a href="#two_factor" class="anchor-heading" aria-labelledby="two_factor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> two_factor </h3> <p>This policy requires the user to complete 2FA successfully. This is currently the highest level of authentication policy available.</p> <h2 id="default-policy"> <a href="#default-policy" class="anchor-heading" aria-labelledby="default-policy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Default Policy </h2> <p>The default policy is the policy applied when no other rule matches. It is recommended that this is configured to <a href="#deny">deny</a> for security reasons. Sites which you do not wish to secure with Authelia should not be configured to perform authentication with Authelia at all.</p> <p>See <a href="#policies">Policies</a> for more information.</p> <h2 id="network-aliases"> <a href="#network-aliases" class="anchor-heading" aria-labelledby="network-aliases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Aliases </h2> <p>The main networks section defines a list of network aliases, where the name matches a list of networks. These names can be used in any <a href="#rules">rule</a> instead of a literal network. This makes it easier to define a group of networks multiple times.</p> <p>You can combine both literal networks and these aliases inside the <a href="#networks">networks</a> section of a rule. See this section for more details.</p> <h2 id="rules"> <a href="#rules" class="anchor-heading" aria-labelledby="rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rules </h2> <p>A rule defines two things:</p> <ul> <li>the matching criteria of the request presented to the reverse proxy</li> <li>the policy applied when all criteria match.</li> </ul> <p>The criteria are:</p> <ul> <li>domain: domain or list of domains targeted by the request.</li> <li>resources: pattern or list of patterns that the path should match.</li> <li>subject: the user or group of users to define the policy for.</li> <li>networks: the network addresses, ranges (CIDR notation) or groups from where the request originates.</li> <li>methods: the http methods used in the request.</li> </ul> <p>A rule is matched when all criteria of the rule match. Rules are evaluated in sequential order, and this is particularly <strong>important</strong> for bypass rules. Bypass rules should generally appear near the top of the rules list.</p> <h3 id="policy"> <a href="#policy" class="anchor-heading" aria-labelledby="policy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Policy </h3> <p>A policy represents the level of authentication the user needs to pass before being authorized to request the resource.</p> <p>See <a href="#policies">Policies</a> for more information.</p> <h3 id="domains"> <a href="#domains" class="anchor-heading" aria-labelledby="domains"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Domains </h3> <p>The domains defined in rules must obviously be either a subdomain of the domain protected by Authelia or the protected domain itself. In order to match multiple subdomains, the wildcard matcher character <code class="language-plaintext highlighter-rouge">*.</code> can be used as prefix of the domain. For instance, to define a rule for all subdomains of <em>example.com</em>, one would use <code class="language-plaintext highlighter-rouge">*.example.com</code> in the rule. A single rule can define multiple domains for matching. These domains can be either listed in YAML-short form <code class="language-plaintext highlighter-rouge">["example1.com", "example2.com"]</code> or in YAML long-form as dashed list.</p> <p>Domain prefixes can also be dynamically match users or groups. For example you can have a specific policy adjustment if the user or group matches the subdomain. For example <code class="language-plaintext highlighter-rouge">{user}.example.com</code> or <code class="language-plaintext highlighter-rouge">{group}.example.com</code> check the users name or groups against the subdomain.</p> <h3 id="resources"> <a href="#resources" class="anchor-heading" aria-labelledby="resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resources </h3> <p>A rule can define multiple regular expressions for matching the path of the resource similar to the list of domains. If any one of them matches, the resource criteria of the rule matches.</p> <p>Note that regular expressions can be used to match a given path. However prior to 4.27.0, they do not match the query parameters in the URL, only the path. If you’re upgrading to 4.27.0+ you may have to alter some resource rules to get them to work as they previously did.</p> <p>You might also face some escaping issues preventing Authelia to start. Please make sure that when you are using regular expressions, you enclose them between quotes. It’s optional but it will likely save you a lot of debugging time.</p> <h3 id="subjects"> <a href="#subjects" class="anchor-heading" aria-labelledby="subjects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Subjects </h3> <p>A subject is a representation of a user or a group of user for who the rule should apply.</p> <p>For a user with unique identifier <code class="language-plaintext highlighter-rouge">john</code>, the subject should be <code class="language-plaintext highlighter-rouge">user:john</code> and for a group uniquely identified by <code class="language-plaintext highlighter-rouge">developers</code>, the subject should be <code class="language-plaintext highlighter-rouge">group:developers</code>. Similar to resources and domains you can define multiple subjects in a single rule.</p> <p>If you want a combination of subjects to be matched at once using a logical <code class="language-plaintext highlighter-rouge">AND</code>, you can specify a nested list of subjects like <code class="language-plaintext highlighter-rouge">- ["group:developers", "group:admins"]</code>. In summary, the first list level of subjects are evaluated using a logical <code class="language-plaintext highlighter-rouge">OR</code>, whereas the second level by a logical <code class="language-plaintext highlighter-rouge">AND</code>. The last example below reads as: the group is <code class="language-plaintext highlighter-rouge">dev</code> AND the username is <code class="language-plaintext highlighter-rouge">john</code> OR the group is <code class="language-plaintext highlighter-rouge">admins</code>.</p> <h4 id="combining-subjects-and-the-bypass-policy"> <a href="#combining-subjects-and-the-bypass-policy" class="anchor-heading" aria-labelledby="combining-subjects-and-the-bypass-policy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Combining subjects and the bypass policy </h4> <p>A subject cannot be combined with the <code class="language-plaintext highlighter-rouge">bypass</code> policy since the minimum authentication level to identify a subject is <code class="language-plaintext highlighter-rouge">one_factor</code>. Combining the <code class="language-plaintext highlighter-rouge">one_factor</code> policy with a subject is effectively the same as setting the policy to <code class="language-plaintext highlighter-rouge">bypass</code> in the past. We have taken an opinionated stance on preventing this configuration as it could result in problematic security scenarios with badly thought out configurations and cannot see a likely configuration scenario that would require users to do this. If you have a scenario in mind please open an <a href="https://github.com/authelia/authelia/issues/new">issue</a> on GitHub.</p> <h3 id="networks"> <a href="#networks" class="anchor-heading" aria-labelledby="networks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Networks </h3> <p>A list of network addresses, ranges (CIDR notation) or groups can be specified in a rule in order to apply different policies when requests originate from different networks. This list can contain both literal definitions of networks and <a href="#network-aliases">network aliases</a>.</p> <p>Network addresses specified will be matched against the first IP in the X-Forwarded-For, and if there is none it will fall back to the IP address of the request. If using Authelia with a reverse proxy, additional configuration may be required on the reverse proxy to ensure these headers are present and correct.</p> <p>Main use cases for this rule option is to adjust the security requirements of a resource based on the location of the user. For example lets say a resource should be exposed both on the Internet and from an authenticated VPN for instance. Passing a second factor a first time to get access to the VPN and a second time to get access to the application can sometimes be cumbersome if the endpoint is not considered overly sensitive.</p> <p>An additional situation where this may be useful is if there is a specific network you wish to deny access or require a higher level of authentication for; like a public machine network vs a company device network, or a BYOD network.</p> <p>Even if Authelia provides this flexibility, you might prefer a higher level of security and avoid this option entirely. You and only you can define your security policy and it’s up to you to configure Authelia accordingly.</p> <h3 id="methods"> <a href="#methods" class="anchor-heading" aria-labelledby="methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Methods </h3> <p>A list of HTTP request methods to apply the rule to. Valid values are GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, and TRACE. Additional information about HTTP request methods can be found on the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">MDN</a>.</p> <p>It’s important to note this policy type is primarily intended for use when you wish to bypass authentication for a specific request method. This is because there are several key limitations in what is possible to accomplish without Authelia being a reverse proxy server. This rule type is discouraged unless you really know what you’re doing or you wish to setup a rule to bypass CORS preflight requests by bypassing for the OPTIONS method.</p> <p>For example, if you require authentication only for write events (POST, PATCH, DELETE, PUT), when a user who is not currently authenticated tries to do one of these actions, they will be redirected to Authelia. Authelia will decide what level is required for authentication, and then after the user authenticates it will redirect them to the original URL where Authelia decided they needed to authenticate. So if the endpoint they are redirected to originally had data sent as part of the request, this data is completely lost. Further if the endpoint expects the data or doesn’t allow GET request types, the user may be presented with an error leading to a bad user experience.</p> <h2 id="complete-example"> <a href="#complete-example" class="anchor-heading" aria-labelledby="complete-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Complete example </h2> <p>Here is a complete example of complex access control list that can be defined in Authelia.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">access_control</span><span class="pi">:</span>
  <span class="na">default_policy</span><span class="pi">:</span> <span class="s">deny</span>
  <span class="na">networks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">internal</span>
      <span class="na">networks</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">10.10.0.0/16</span>
        <span class="pi">-</span> <span class="s">192.168.2.0/24</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">VPN</span>
      <span class="na">networks</span><span class="pi">:</span> <span class="s">10.9.0.0/16</span>
  <span class="na">rules</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s">public.example.com</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">bypass</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*.example.com"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">bypass</span>
      <span class="na">methods</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">OPTIONS</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s">secure.example.com</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">one_factor</span>
      <span class="na">networks</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">internal</span>
        <span class="pi">-</span> <span class="s">VPN</span>
        <span class="pi">-</span> <span class="s">192.168.1.0/24</span>
        <span class="pi">-</span> <span class="s">10.0.0.1</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">secure.example.com</span>
      <span class="pi">-</span> <span class="s">private.example.com</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">two_factor</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s">singlefactor.example.com</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">one_factor</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s2">"</span><span class="s">mx2.mail.example.com"</span>
      <span class="na">subject</span><span class="pi">:</span> <span class="s2">"</span><span class="s">group:admins"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">deny</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s2">"</span><span class="s">*.example.com"</span>
      <span class="na">subject</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">group:admins"</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">group:moderators"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">two_factor</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s">dev.example.com</span>
      <span class="na">resources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">^/groups/dev/.*$"</span>
      <span class="na">subject</span><span class="pi">:</span> <span class="s2">"</span><span class="s">group:dev"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">two_factor</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s">dev.example.com</span>
      <span class="na">resources</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">^/users/john/.*$"</span>
      <span class="na">subject</span><span class="pi">:</span> 
      <span class="pi">-</span> <span class="pi">[</span><span class="s2">"</span><span class="s">group:dev"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">user:john"</span><span class="pi">]</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">group:admins"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">two_factor</span>

    <span class="pi">-</span> <span class="na">domain</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{user}.example.com"</span>
      <span class="na">policy</span><span class="pi">:</span> <span class="s">bypass</span>
</code></pre></div></div> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2021 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a> </p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
