<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Secrets - Authelia</title> <link rel="shortcut icon" href="https://www.authelia.com/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="https://www.authelia.com/docs/assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-124926127-1"); </script> <script type="text/javascript" src="https://www.authelia.com/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="https://www.authelia.com/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Secrets | Authelia</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Secrets" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <link rel="canonical" href="https://www.authelia.com/docs/configuration/secrets.html" /> <meta property="og:url" content="https://www.authelia.com/docs/configuration/secrets.html" /> <meta property="og:site_name" content="Authelia" /> <script type="application/ld+json"> {"@type":"WebPage","url":"https://www.authelia.com/docs/configuration/secrets.html","headline":"Secrets","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.authelia.com/docs/images/authelia-title.png"}},"description":"Authelia is an open source multi-factor single sign-on portal for web applications","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"> </path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="https://www.authelia.com/docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="https://www.authelia.com/docs/" class="navigation-list-link">Home</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/home/architecture.html" class="navigation-list-link">Architecture</a></li></ul></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/getting-started.html" class="navigation-list-link">Getting Started</a></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/features/" class="navigation-list-link">Features</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/first-factor.html" class="navigation-list-link">First Factor</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/2fa/" class="navigation-list-link">Second Factor</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/features/2fa/one-time-password.html" class="navigation-list-link">One-Time Password</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/features/2fa/security-key.html" class="navigation-list-link">Security Keys</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/features/2fa/push-notifications.html" class="navigation-list-link">Push Notification</a> </li></ul></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/single-factor.html" class="navigation-list-link">Single Factor</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/password-reset.html" class="navigation-list-link">Password Reset</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/features/regulation.html" class="navigation-list-link">Regulation</a></li></ul></li><li class="navigation-list-item active"><a href="https://www.authelia.com/docs/configuration/" class="navigation-list-link">Configuration</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/access-control.html" class="navigation-list-link">Access Control</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/authentication/" class="navigation-list-link">Authentication backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/authentication/file.html" class="navigation-list-link">File</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/authentication/ldap.html" class="navigation-list-link">LDAP</a> </li></ul></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/duo-push-notifications.html" class="navigation-list-link">Duo Push Notifications</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/miscellaneous.html" class="navigation-list-link">Miscellaneous</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/one-time-password.html" class="navigation-list-link">One-Time Password</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/regulation.html" class="navigation-list-link">Regulation</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/notifier/" class="navigation-list-link">Notifier</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/notifier/filesystem.html" class="navigation-list-link">Filesystem</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/notifier/smtp.html" class="navigation-list-link">SMTP</a> </li></ul></li><li class="navigation-list-item active"><a href="https://www.authelia.com/docs/configuration/secrets.html" class="navigation-list-link active">Secrets</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/server.html" class="navigation-list-link">Server</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/session.html" class="navigation-list-link">Session</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/configuration/storage/" class="navigation-list-link">Storage backends</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/storage/mariadb.html" class="navigation-list-link">MariaDB</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/storage/mysql.html" class="navigation-list-link">MySQL</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/storage/postgres.html" class="navigation-list-link">PostgreSQL</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/configuration/storage/sqlite.html" class="navigation-list-link">SQLite</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/deployment/" class="navigation-list-link">Deployment</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/deployment/deployment-lite.html" class="navigation-list-link">Deployment - Lite</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/deployment/deployment-ha.html" class="navigation-list-link">Deployment - Highly-Available</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/deployment/deployment-kubernetes.html" class="navigation-list-link">Deployment - Kubernetes</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/deployment/supported-proxies/" class="navigation-list-link">Proxy Integration</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/deployment/supported-proxies/haproxy.html" class="navigation-list-link">HAProxy</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/deployment/supported-proxies/nginx.html" class="navigation-list-link">Nginx</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/deployment/supported-proxies/traefik1.x.html" class="navigation-list-link">Traefik 1.x</a> </li><li class="navigation-list-item "> <a href="https://www.authelia.com/docs/deployment/supported-proxies/traefik2.x.html" class="navigation-list-link">Traefik 2.x</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/security/" class="navigation-list-link">Security</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/security/measures.html" class="navigation-list-link">Security Measures</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/security/threat-model.html" class="navigation-list-link">Threat Model</a></li></ul></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/contributing/" class="navigation-list-link">Contributing</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/contributing/authelia-scripts.html" class="navigation-list-link">Authelia Scripts</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/contributing/build-and-dev.html" class="navigation-list-link">Build & Dev</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/contributing/suites.html" class="navigation-list-link">Suites</a></li></ul></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/faq.html" class="navigation-list-link">FAQ</a></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/roadmap.html" class="navigation-list-link">Roadmap</a></li><li class="navigation-list-item"><a href="https://www.authelia.com/docs/community/" class="navigation-list-link">Community</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="https://www.authelia.com/docs/community/two-factor-basic-auth.html" class="navigation-list-link">2FA through basic auth</a></li><li class="navigation-list-item "><a href="https://www.authelia.com/docs/community/using-remote-user-header-for-sso-with-jira.html" class="navigation-list-link">Using Remote-User header for SSO with Jira</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"> <title>Search</title> <g fill-rule="nonzero"> <path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z" /> <path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z" /> </g> </svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://www.authelia.com/docs/configuration/">Configuration</a> </li> <li class="breadcrumb-nav-list-item"><span>Secrets</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 id="secrets"> <a href="#secrets" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Secrets </h1> <p>Configuration of Authelia requires some secrets and passwords. Even if they can be set in the configuration file, the recommended way to set secrets is to use environment variables as described below.</p> <h2 id="environment-variables"> <a href="#environment-variables" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Environment variables </h2> <p>A secret can be configured using an environment variable with the prefix AUTHELIA_ followed by the path of the option capitalized and with dots replaced by underscores followed by the suffix _FILE.</p> <p>The contents of the environment variable must be a path to a file containing the secret data. This file must be readable by the user the Authelia daemon is running as.</p> <p>For instance the LDAP password can be defined in the configuration at the path <strong>authentication_backend.ldap.password</strong>, so this password could alternatively be set using the environment variable called <strong>AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</strong>.</p> <p>Here is the list of the environment variables which are considered secrets and can be defined. Any other option defined using an environment variable will not be replaced.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: center">Configuration Key</th> <th style="text-align: center">Environment Variable</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">jwt_secret</td> <td style="text-align: center">AUTHELIA_JWT_SECRET_FILE</td> </tr> <tr> <td style="text-align: center">duo_api.secret_key</td> <td style="text-align: center">AUTHELIA_DUO_API_SECRET_KEY_FILE</td> </tr> <tr> <td style="text-align: center">session.secret</td> <td style="text-align: center">AUTHELIA_SESSION_SECRET_FILE</td> </tr> <tr> <td style="text-align: center">session.redis.password</td> <td style="text-align: center">AUTHELIA_SESSION_REDIS_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">storage.mysql.password</td> <td style="text-align: center">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">storage.postgres.password</td> <td style="text-align: center">AUTHELIA_STORAGE_POSTGRES_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">notifier.smtp.password</td> <td style="text-align: center">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">authentication_backend.ldap.password</td> <td style="text-align: center">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</td> </tr> </tbody> </table></div> <h2 id="secrets-in-configuration-file"> <a href="#secrets-in-configuration-file" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Secrets in configuration file </h2> <p>If for some reason you prefer keeping the secrets in the configuration file, be sure to apply the right permissions to the file in order to prevent secret leaks if an another application gets compromised on your server. The UNIX permissions should probably be something like 600.</p> <h2 id="secrets-exposed-in-an-environment-variable"> <a href="#secrets-exposed-in-an-environment-variable" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Secrets exposed in an environment variable </h2> <p><strong>DEPRECATION NOTICE:</strong> This backwards compatibility feature <strong>has been removed</strong> in 4.18.0+.</p> <p>Prior to implementing file secrets you were able to define the values of secrets in the environment variables themselves in plain text instead of referencing a file. <strong>This is no longer available as an option</strong>, please see the table above for the file based replacements. See <a href="https://diogomonica.com/2017/03/27/why-you-shouldnt-use-env-variables-for-secret-data/">this article</a> for reasons why this was removed.</p> <h2 id="docker"> <a href="#docker" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Docker </h2> <p>Secrets can be provided in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> either with Docker secrets or bind mounted secret files, examples of these are provided below.</p> <h3 id="compose-with-docker-secrets"> <a href="#compose-with-docker-secrets" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Compose with Docker secrets </h3> <p>This example assumes secrets are stored in <code class="language-plaintext highlighter-rouge">/path/to/authelia/secrets/{secretname}</code> on the host and are exposed with Docker secrets in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">net</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>

<span class="na">secrets</span><span class="pi">:</span>
  <span class="na">jwt</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/jwt</span>
  <span class="na">duo</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/duo</span>
  <span class="na">session</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/session</span>
  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/redis</span>
  <span class="na">mysql</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/mysql</span>
  <span class="na">smtp</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/smtp</span>
  <span class="na">ldap</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/ldap</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">authelia</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">secrets</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">jwt</span>
      <span class="pi">-</span> <span class="s">duo</span>
      <span class="pi">-</span> <span class="s">session</span>
      <span class="pi">-</span> <span class="s">redis</span>
      <span class="pi">-</span> <span class="s">mysql</span>
      <span class="pi">-</span> <span class="s">smtp</span>
      <span class="pi">-</span> <span class="s">ldap</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia:/var/lib/authelia</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia/configuration.yml:/etc/authelia/configuration.yml:ro</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9091</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_JWT_SECRET_FILE=/run/secrets/jwt</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE=/run/secrets/duo</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE=/run/secrets/session</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_REDIS_PASSWORD_FILE=/run/secrets/redis</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE=/run/secrets/mysql</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE=/run/secrets/smtp</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE=/run/secrets/ldap</span>
      <span class="pi">-</span> <span class="s">TZ=Australia/Melbourne</span>
</code></pre></div></div> <h3 id="compose-with-bind-mounted-secret-files"> <a href="#compose-with-bind-mounted-secret-files" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Compose with bind mounted secret files </h3> <p>This example assumes secrets are stored in <code class="language-plaintext highlighter-rouge">/path/to/authelia/secrets/{secretname}</code> on the host and are exposed with bind mounted secret files in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file at <code class="language-plaintext highlighter-rouge">/etc/authelia/secrets/</code>:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">net</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">authelia</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia:/var/lib/authelia</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia/configuration.yml:/etc/authelia/configuration.yml:ro</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia/secrets:/etc/authelia/secrets</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9091</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_JWT_SECRET_FILE=/etc/authelia/secrets/jwt</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE=/etc/authelia/secrets/duo</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE=/etc/authelia/secrets/session</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_REDIS_PASSWORD_FILE=/etc/authelia/secrets/redis</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE=/etc/authelia/secrets/mysql</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE=/etc/authelia/secrets/smtp</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE=/etc/authelia/secrets/ldap</span>
      <span class="pi">-</span> <span class="s">TZ=Australia/Melbourne</span>
</code></pre></div></div> <h2 id="kubernetes"> <a href="#kubernetes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Kubernetes </h2> <p>Secrets can be mounted as files using the following sample manifests.</p> <h3 id="kustomization"> <a href="#kustomization" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Kustomization </h3> <ul> <li><strong>Filename:</strong> ./kustomization.yaml</li> <li><strong>Command:</strong> kubectl apply -k</li> <li><strong>Notes:</strong> this kustomization expects the Authelia configuration.yml in the same directory. You will need to edit the kustomization.yaml with your desired secrets after the equal signs. If you change the value before the equal sign you’ll have to adjust the volumes section of the daemonset template (or deployment template if you’re using it).</li> </ul> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filename: ./kustomization.yaml</span>
<span class="na">generatorOptions</span><span class="pi">:</span>
  <span class="na">disableNameSuffixHash</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">generated</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">files</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">configuration.yml</span>
<span class="na">secretGenerator</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">literals</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">jwt_secret=myverysecuresecret</span>
      <span class="pi">-</span> <span class="s">session_secret=mysessionsecret</span>
      <span class="pi">-</span> <span class="s">redis_password=myredispassword</span>
      <span class="pi">-</span> <span class="s">sql_password=mysqlpassword</span>
      <span class="pi">-</span> <span class="s">ldap_password=myldappassword</span>
      <span class="pi">-</span> <span class="s">duo_secret=myduosecretkey</span>
      <span class="pi">-</span> <span class="s">smtp_password=mysmtppassword</span>
</code></pre></div></div> <h3 id="daemonset"> <a href="#daemonset" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> DaemonSet </h3> <ul> <li><strong>Filename:</strong> ./daemonset.yaml</li> <li><strong>Command:</strong> kubectl apply -f ./daemonset.yaml</li> <li><strong>Notes:</strong> assumes Kubernetes API 1.16 or greater <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filename: daemonset.yaml</span>
<span class="c1">#command: kubectl apply -f daemonset.yaml</span>
<span class="c1">#notes: assumes kubernetes api 1.16+</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">DaemonSet</span>
<span class="na">metadata</span><span class="pi">:</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">labels</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">spec</span><span class="pi">:</span>
<span class="na">selector</span><span class="pi">:</span>
  <span class="na">matchLabels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">updateStrategy</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">RollingUpdate</span>
<span class="na">template</span><span class="pi">:</span>
  <span class="na">metadata</span><span class="pi">:</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
  <span class="na">spec</span><span class="pi">:</span>
    <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia:latest</span>
        <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_JWT_SECRET_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/jwt</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/duo</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/session</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/ldap_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/smtp_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_STORAGE_POSTGRES_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/usr/app/secrets/sql_password</span>
        <span class="na">ports</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http</span>
            <span class="na">containerPort</span><span class="pi">:</span> <span class="m">80</span>
        <span class="na">startupProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/configuration</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">http</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">10</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">4</span>
        <span class="na">livenessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/configuration</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">http</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">60</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">30</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">2</span>
        <span class="na">readinessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/configuration</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">http</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">10</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">5</span>
        <span class="na">volumeMounts</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/etc/authelia</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
          <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/usr/app/secrets</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">secrets</span>
            <span class="na">readOnly</span><span class="pi">:</span> <span class="no">true</span>
          <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/etc/localtime</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">localtime</span>
            <span class="na">readOnly</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
        <span class="na">configMap</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
          <span class="na">items</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">configuration.yml</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">configuration.yml</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">secrets</span>
        <span class="na">secret</span><span class="pi">:</span>
          <span class="na">secretName</span><span class="pi">:</span> <span class="s">authelia</span>
          <span class="na">items</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">jwt_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">jwt</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">duo_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">duo</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">session_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">session</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">redis_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">redis_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">sql_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">sql_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">ldap_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">ldap_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">smtp_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">smtp_password</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">localtime</span>
        <span class="na">hostPath</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">/etc/localtime</span>
</code></pre></div> </div> </li> </ul> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
