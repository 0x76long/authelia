<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Secrets - Authelia</title> <link rel="shortcut icon" href="/docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124926127-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-124926127-1'); </script> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Secrets | Authelia</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Secrets" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:description" content="Authelia is an open source multi-factor single sign-on portal for web applications" /> <meta property="og:site_name" content="Authelia" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Secrets" /> <script type="application/ld+json"> {"description":"Authelia is an open source multi-factor single sign-on portal for web applications","url":"/docs/configuration/secrets.html","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/images/authelia-title.png"}},"headline":"Secrets","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" /> </head> <body> <a class="github-fork-ribbon" href="https://github.com/authelia/authelia" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/docs/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/" class="nav-list-link">Home</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/home/architecture.html" class="nav-list-link">Architecture</a></li></ul></li><li class="nav-list-item"><a href="/docs/getting-started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/" class="nav-list-link">Features</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/features/first-factor.html" class="nav-list-link">First Factor</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/features/2fa/" class="nav-list-link">Second Factor</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/features/2fa/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/security-key.html" class="nav-list-link">Security Keys</a> </li><li class="nav-list-item "> <a href="/docs/features/2fa/push-notifications.html" class="nav-list-link">Push Notification</a> </li></ul></li><li class="nav-list-item "><a href="/docs/features/single-factor.html" class="nav-list-link">Single Factor</a></li><li class="nav-list-item "><a href="/docs/features/password-reset.html" class="nav-list-link">Password Reset</a></li><li class="nav-list-item "><a href="/docs/features/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="/docs/features/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="/docs/features/statelessness.html" class="nav-list-link">Statelessness</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/" class="nav-list-link">Configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/configuration/access-control.html" class="nav-list-link">Access Control</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/authentication/" class="nav-list-link">Authentication backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/authentication/file.html" class="nav-list-link">File</a> </li><li class="nav-list-item "> <a href="/docs/configuration/authentication/ldap.html" class="nav-list-link">LDAP</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/duo-push-notifications.html" class="nav-list-link">Duo Push Notifications</a></li><li class="nav-list-item "><a href="/docs/configuration/miscellaneous.html" class="nav-list-link">Miscellaneous</a></li><li class="nav-list-item "><a href="/docs/configuration/one-time-password.html" class="nav-list-link">Time-based One-Time Password</a></li><li class="nav-list-item "><a href="/docs/configuration/regulation.html" class="nav-list-link">Regulation</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/notifier/" class="nav-list-link">Notifier</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/notifier/filesystem.html" class="nav-list-link">Filesystem</a> </li><li class="nav-list-item "> <a href="/docs/configuration/notifier/smtp.html" class="nav-list-link">SMTP</a> </li></ul></li><li class="nav-list-item active"><a href="/docs/configuration/secrets.html" class="nav-list-link active">Secrets</a></li><li class="nav-list-item "><a href="/docs/configuration/server.html" class="nav-list-link">Server</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/session/" class="nav-list-link">Session</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/session/redis.html" class="nav-list-link">Redis</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/configuration/storage/" class="nav-list-link">Storage backends</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/configuration/storage/mariadb.html" class="nav-list-link">MariaDB</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/mysql.html" class="nav-list-link">MySQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/postgres.html" class="nav-list-link">PostgreSQL</a> </li><li class="nav-list-item "> <a href="/docs/configuration/storage/sqlite.html" class="nav-list-link">SQLite</a> </li></ul></li><li class="nav-list-item "><a href="/docs/configuration/theme.html" class="nav-list-link">Theme</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/" class="nav-list-link">Deployment</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/deployment/deployment-lite.html" class="nav-list-link">Deployment - Lite</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-ha.html" class="nav-list-link">Deployment - Highly-Available</a></li><li class="nav-list-item "><a href="/docs/deployment/deployment-kubernetes.html" class="nav-list-link">Deployment - Kubernetes</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/supported-proxies/" class="nav-list-link">Proxy Integration</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/haproxy.html" class="nav-list-link">HAProxy</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/nginx.html" class="nav-list-link">Nginx</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik2.x.html" class="nav-list-link">Traefik 2.x</a> </li><li class="nav-list-item "> <a href="/docs/deployment/supported-proxies/traefik1.x.html" class="nav-list-link">Traefik 1.x</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/security/" class="nav-list-link">Security</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/security/measures.html" class="nav-list-link">Security Measures</a></li><li class="nav-list-item "><a href="/docs/security/threat-model.html" class="nav-list-link">Threat Model</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/contributing/" class="nav-list-link">Contributing</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/contributing/build-and-dev.html" class="nav-list-link">Build & Dev</a></li><li class="nav-list-item "><a href="/docs/contributing/authelia-scripts.html" class="nav-list-link">Authelia Scripts</a></li><li class="nav-list-item "><a href="/docs/contributing/commitmsg-guidelines.html" class="nav-list-link">Commit Message Guidelines</a></li><li class="nav-list-item "><a href="/docs/contributing/style-guide.html" class="nav-list-link">Style Guide</a></li><li class="nav-list-item "><a href="/docs/contributing/suites.html" class="nav-list-link">Suites</a></li></ul></li><li class="nav-list-item"><a href="/docs/faq.html" class="nav-list-link">FAQ</a></li><li class="nav-list-item"><a href="/docs/roadmap.html" class="nav-list-link">Roadmap</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/community/" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/community/two-factor-basic-auth.html" class="nav-list-link">2FA through basic auth</a></li><li class="nav-list-item "><a href="/docs/community/using-remote-user-header-for-sso-with-jira.html" class="nav-list-link">Using Remote-User header for SSO with Jira</a></li><li class="nav-list-item "><a href="/docs/community/additional-resources.html" class="nav-list-link">Miscellaneous Additional Resources</a></li><li class="nav-list-item "><a href="/docs/community/example-of-authelia-lite-on-docker-swarm.html" class="nav-list-link">Example of authelia lite on docker swarm</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Authelia" aria-label="Search Authelia" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Configuration</a></li> <li class="breadcrumb-nav-list-item"><span>Secrets</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="secrets"> <a href="#secrets" class="anchor-heading" aria-labelledby="secrets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secrets </h1> <p>Configuration of Authelia requires some secrets and passwords. Even if they can be set in the configuration file, the recommended way to set secrets is to use environment variables as described below.</p> <h2 id="environment-variables"> <a href="#environment-variables" class="anchor-heading" aria-labelledby="environment-variables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Environment variables </h2> <p>A secret can be configured using an environment variable with the prefix AUTHELIA_ followed by the path of the option capitalized and with dots replaced by underscores followed by the suffix _FILE.</p> <p>The contents of the environment variable must be a path to a file containing the secret data. This file must be readable by the user the Authelia daemon is running as.</p> <p>For instance the LDAP password can be defined in the configuration at the path <strong>authentication_backend.ldap.password</strong>, so this password could alternatively be set using the environment variable called <strong>AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</strong>.</p> <p>Here is the list of the environment variables which are considered secrets and can be defined. Any other option defined using an environment variable will not be replaced.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: center">Configuration Key</th> <th style="text-align: center">Environment Variable</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">jwt_secret</td> <td style="text-align: center">AUTHELIA_JWT_SECRET_FILE</td> </tr> <tr> <td style="text-align: center">duo_api.secret_key</td> <td style="text-align: center">AUTHELIA_DUO_API_SECRET_KEY_FILE</td> </tr> <tr> <td style="text-align: center">session.secret</td> <td style="text-align: center">AUTHELIA_SESSION_SECRET_FILE</td> </tr> <tr> <td style="text-align: center">session.redis.password</td> <td style="text-align: center">AUTHELIA_SESSION_REDIS_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">session.redis.high_availability.sentinel_password</td> <td style="text-align: center">AUTHELIA_REDIS_HIGH_AVAILABILITY_SENTINEL_PASSWORD</td> </tr> <tr> <td style="text-align: center">storage.mysql.password</td> <td style="text-align: center">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">storage.postgres.password</td> <td style="text-align: center">AUTHELIA_STORAGE_POSTGRES_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">notifier.smtp.password</td> <td style="text-align: center">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE</td> </tr> <tr> <td style="text-align: center">authentication_backend.ldap.password</td> <td style="text-align: center">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</td> </tr> </tbody> </table></div> <h2 id="secrets-in-configuration-file"> <a href="#secrets-in-configuration-file" class="anchor-heading" aria-labelledby="secrets-in-configuration-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secrets in configuration file </h2> <p>If for some reason you prefer keeping the secrets in the configuration file, be sure to apply the right permissions to the file in order to prevent secret leaks if an another application gets compromised on your server. The UNIX permissions should probably be something like 600.</p> <h2 id="secrets-exposed-in-an-environment-variable"> <a href="#secrets-exposed-in-an-environment-variable" class="anchor-heading" aria-labelledby="secrets-exposed-in-an-environment-variable"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secrets exposed in an environment variable </h2> <p><strong>DEPRECATION NOTICE:</strong> This backwards compatibility feature <strong>has been removed</strong> in 4.18.0+.</p> <p>Prior to implementing file secrets you were able to define the values of secrets in the environment variables themselves in plain text instead of referencing a file. <strong>This is no longer available as an option</strong>, please see the table above for the file based replacements. See <a href="https://diogomonica.com/2017/03/27/why-you-shouldnt-use-env-variables-for-secret-data/">this article</a> for reasons why this was removed.</p> <h2 id="docker"> <a href="#docker" class="anchor-heading" aria-labelledby="docker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Docker </h2> <p>Secrets can be provided in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> either with Docker secrets or bind mounted secret files, examples of these are provided below.</p> <h3 id="compose-with-docker-secrets"> <a href="#compose-with-docker-secrets" class="anchor-heading" aria-labelledby="compose-with-docker-secrets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compose with Docker secrets </h3> <p>This example assumes secrets are stored in <code class="language-plaintext highlighter-rouge">/path/to/authelia/secrets/{secretname}</code> on the host and are exposed with Docker secrets in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">net</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>

<span class="na">secrets</span><span class="pi">:</span>
  <span class="na">jwt</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/jwt</span>
  <span class="na">duo</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/duo</span>
  <span class="na">session</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/session</span>
  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/redis</span>
  <span class="na">mysql</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/mysql</span>
  <span class="na">smtp</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/smtp</span>
  <span class="na">ldap</span><span class="pi">:</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s">/path/to/authelia/secrets/ldap</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">authelia</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">secrets</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">jwt</span>
      <span class="pi">-</span> <span class="s">duo</span>
      <span class="pi">-</span> <span class="s">session</span>
      <span class="pi">-</span> <span class="s">redis</span>
      <span class="pi">-</span> <span class="s">mysql</span>
      <span class="pi">-</span> <span class="s">smtp</span>
      <span class="pi">-</span> <span class="s">ldap</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia:/config</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9091</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_JWT_SECRET_FILE=/run/secrets/jwt</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE=/run/secrets/duo</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE=/run/secrets/session</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_REDIS_PASSWORD_FILE=/run/secrets/redis</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE=/run/secrets/mysql</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE=/run/secrets/smtp</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE=/run/secrets/ldap</span>
      <span class="pi">-</span> <span class="s">TZ=Australia/Melbourne</span>
</code></pre></div></div> <h3 id="compose-with-bind-mounted-secret-files"> <a href="#compose-with-bind-mounted-secret-files" class="anchor-heading" aria-labelledby="compose-with-bind-mounted-secret-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compose with bind mounted secret files </h3> <p>This example assumes secrets are stored in <code class="language-plaintext highlighter-rouge">/path/to/authelia/secrets/{secretname}</code> on the host and are exposed with bind mounted secret files in a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file at <code class="language-plaintext highlighter-rouge">/config/secrets/</code>:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">net</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">authelia</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/path/to/authelia:/config</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">net</span>
    <span class="na">expose</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">9091</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_JWT_SECRET_FILE=/config/secrets/jwt</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE=/config/secrets/duo</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE=/config/secrets/session</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_SESSION_REDIS_PASSWORD_FILE=/config/secrets/redis</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE=/config/secrets/mysql</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE=/config/secrets/smtp</span>
      <span class="pi">-</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE=/config/secrets/ldap</span>
      <span class="pi">-</span> <span class="s">TZ=Australia/Melbourne</span>
</code></pre></div></div> <h2 id="kubernetes"> <a href="#kubernetes" class="anchor-heading" aria-labelledby="kubernetes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kubernetes </h2> <p>Secrets can be mounted as files using the following sample manifests.</p> <h3 id="kustomization"> <a href="#kustomization" class="anchor-heading" aria-labelledby="kustomization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kustomization </h3> <ul> <li><strong>Filename:</strong> ./kustomization.yaml</li> <li><strong>Command:</strong> kubectl apply -k</li> <li><strong>Notes:</strong> this kustomization expects the Authelia configuration.yml in the same directory. You will need to edit the kustomization.yaml with your desired secrets after the equal signs. If you change the value before the equal sign you’ll have to adjust the volumes section of the daemonset template (or deployment template if you’re using it).</li> </ul> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filename: ./kustomization.yaml</span>
<span class="na">generatorOptions</span><span class="pi">:</span>
  <span class="na">disableNameSuffixHash</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">generated</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">configMapGenerator</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">files</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">configuration.yml</span>
<span class="na">secretGenerator</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
    <span class="na">literals</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">jwt_secret=myverysecuresecret</span>
      <span class="pi">-</span> <span class="s">session_secret=mysessionsecret</span>
      <span class="pi">-</span> <span class="s">redis_password=myredispassword</span>
      <span class="pi">-</span> <span class="s">sql_password=mysqlpassword</span>
      <span class="pi">-</span> <span class="s">ldap_password=myldappassword</span>
      <span class="pi">-</span> <span class="s">duo_secret=myduosecretkey</span>
      <span class="pi">-</span> <span class="s">smtp_password=mysmtppassword</span>
</code></pre></div></div> <h3 id="daemonset"> <a href="#daemonset" class="anchor-heading" aria-labelledby="daemonset"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DaemonSet </h3> <ul> <li><strong>Filename:</strong> ./daemonset.yaml</li> <li><strong>Command:</strong> kubectl apply -f ./daemonset.yaml</li> <li><strong>Notes:</strong> assumes Kubernetes API 1.16 or greater <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filename: daemonset.yaml</span>
<span class="c1">#command: kubectl apply -f daemonset.yaml</span>
<span class="c1">#notes: assumes kubernetes api 1.16+</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">DaemonSet</span>
<span class="na">metadata</span><span class="pi">:</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">namespace</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">labels</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">spec</span><span class="pi">:</span>
<span class="na">selector</span><span class="pi">:</span>
  <span class="na">matchLabels</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
<span class="na">updateStrategy</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">RollingUpdate</span>
<span class="na">template</span><span class="pi">:</span>
  <span class="na">metadata</span><span class="pi">:</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">authelia</span>
  <span class="na">spec</span><span class="pi">:</span>
    <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">authelia/authelia:latest</span>
        <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_JWT_SECRET_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/jwt</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_DUO_API_SECRET_KEY_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/duo</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_SESSION_SECRET_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/session</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_AUTHENTICATION_BACKEND_LDAP_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/ldap_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_NOTIFIER_SMTP_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/smtp_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_STORAGE_MYSQL_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/sql_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">AUTHELIA_SESSION_REDIS_PASSWORD_FILE</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">/app/secrets/redis_password</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">TZ</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">America/Toronto</span>
        <span class="na">ports</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">authelia-port</span>
            <span class="na">containerPort</span><span class="pi">:</span> <span class="m">9091</span>
        <span class="na">startupProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/state</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">authelia-port</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">15</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">4</span>
        <span class="na">livenessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/state</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">authelia-port</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">60</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">30</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">2</span>
        <span class="na">readinessProbe</span><span class="pi">:</span>
          <span class="na">httpGet</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">/api/state</span>
            <span class="na">port</span><span class="pi">:</span> <span class="s">authelia-port</span>
          <span class="na">initialDelaySeconds</span><span class="pi">:</span> <span class="m">15</span>
          <span class="na">timeoutSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">5</span>
          <span class="na">failureThreshold</span><span class="pi">:</span> <span class="m">5</span>
        <span class="na">volumeMounts</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/config</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
          <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/app/secrets</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">secrets</span>
            <span class="na">readOnly</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config-volume</span>
        <span class="na">configMap</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">authelia</span>
          <span class="na">items</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">configuration.yml</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">configuration.yml</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">secrets</span>
        <span class="na">secret</span><span class="pi">:</span>
          <span class="na">secretName</span><span class="pi">:</span> <span class="s">authelia</span>
          <span class="na">items</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">jwt_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">jwt</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">duo_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">duo</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">session_secret</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">session</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">redis_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">redis_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">sql_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">sql_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">ldap_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">ldap_password</span>
            <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">smtp_password</span>
              <span class="na">path</span><span class="pi">:</span> <span class="s">smtp_password</span>
</code></pre></div> </div> </li> </ul> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2021 Authelia. Distributed by an <a href="https://github.com/authelia/authelia/blob/master/LICENSE">Apache 2.0 license.</a> </p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
